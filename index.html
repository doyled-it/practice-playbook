<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Practice Playbook</title>
  <meta name="theme-color" content="#0b0b10" />
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-bar">
    <div class="brand">â›³ Practice Playbook</div>
    <div class="actions">
      <button id="themeBtn" aria-label="Toggle theme">ðŸŒ“</button>
    </div>
  </header>

  <nav class="topnav">
    <button data-route="#home" class="navlink active">Home</button>
    <button data-route="#practice" class="navlink">Practice</button>
    <button data-route="#history" class="navlink">History</button>
    <button data-route="#trends" class="navlink">Trends</button>
  </nav>

  <main id="view"></main>

  <template id="homeTmpl">
    <section class="home">
      <h1>Plan a Session</h1>
      <div class="card plan">
        <div class="field">
          <label>Location</label>
          <select id="locSelect"></select>
        </div>
        <div class="field">
          <label>Routine</label>
          <select id="routineSelect"></select>
        </div>
        <div class="field">
          <label>Duration (minutes)</label>
          <input type="number" id="durationInput" min="5" max="240" />
        </div>
        <div class="field">
          <label>Notes (optional)</label>
          <textarea id="planNotes" placeholder="Goals, focus, course vibesâ€¦"></textarea>
        </div>
        <div class="actions-row stack">
          <button id="startSessionBtn" class="pill">Start Session â–¶</button>
        </div>
      </div>

      <div class="card tips">
        <h2>Data Backup</h2>
        <p>Sessions are saved in IndexedDB (offline capable). You can export/import to move data across devices.</p>
        <div class="actions-row stack">
          <button id="exportBtn" class="pill ghost">Export JSON</button>
          <label class="importer pill ghost">Import JSON<input type="file" id="importInput" accept="application/json"></label>
        </div>
      </div>
    </section>
  </template>

  <template id="practiceTmpl">
    <section class="practice">
      <div class="headerline">
        <div class="kicker" id="practiceMeta"></div>
        <div class="kicker">
          <span id="timerDisplay">00:00</span>
          <button id="timerToggle" class="chip">Pause</button>
          <button id="timerAdd" class="chip">+1m</button>
        </div>
      </div>

      <nav class="tabs" id="tabs"></nav>

      <div class="stage">
        <div class="carousel" id="carousel" aria-live="polite"></div>
      </div>

      <footer class="footer">
        <button id="prevBtn" class="pill">â—€ Prev</button>
        <div id="stepIndicator" class="indicator">1/5</div>
        <button id="saveBtn" class="pill ghost">Save Step</button>
        <button id="endBtn" class="pill ghost">Save Session</button>
        <button id="nextBtn" class="pill">Next â–¶</button>
      </footer>
    </section>
  </template>

  <template id="historyTmpl">
    <section class="history">
      <h1>Past Sessions</h1>
      <div class="filters">
        <select id="filterLoc"><option value="">All Locations</option></select>
        <input id="filterText" placeholder="Search notes / routine">
      </div>
      <div id="historyList" class="list"></div>
    </section>
  </template>

  <template id="trendsTmpl">
    <section class="trends">
      <h1>Trends</h1>
      <div class="filters">
        <select id="metricSelect"><option value="">Select a metricâ€¦</option></select>
        <select id="metricLoc"><option value="">Any Location</option></select>
      </div>
      <canvas id="trendChart" height="260"></canvas>
      <div id="trendNote" class="kicker"></div>
    </section>
  </template>

  <!-- Save dialog for Simulator attachments (post-practice) -->
  <div id="saveDialog" class="dialog hidden" role="dialog" aria-modal="true">
    <div class="dialog-card">
      <h2>Save Session</h2>
      <div id="simAttach" class="section sim hidden">
        <h3>Simulator Attachments</h3>
        <div class="field">
          <label>Links (comma-separated)</label>
          <input type="text" id="simLinks" placeholder="https://..., https://...">
        </div>
        <div class="field">
          <label>Screenshots / PDFs</label>
          <input type="file" id="simFiles" accept="image/*,application/pdf" multiple>
          <small>Stored locally via IndexedDB. For many large files, prefer cloud links.</small>
        </div>
      </div>
      <div class="actions-row stack">
        <button id="cancelSave" class="pill ghost">Cancel</button>
        <button id="confirmSave" class="pill">Save</button>
      </div>
    </div>
  </div>

  <script src="idb.js"></script>
  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js');
      });
    }
  </script>
</body>
</html>
